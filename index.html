<script>

	 var dataBase = (function(){

	 		var createDatabase = function(name) //creats database of name
	 		{

	 			if(localStorage.getItem(name))
	 			{
	 				console.error("Database of that name already exists!");
	 				return;
	 			}
	 			var nameArray = new Object()
	 			localStorage.setItem(name, JSON.stringify(nameArray));
	 			
	 			
	 		}

			var newTable = function(database, name, options) //SETS UP AND ADDS A TABLE TO DATABASE INSTANCE IN LOCAL STORAGE
			 	{
			 		
				 		var loopVar = 0;
				 		var dataBaseArray = new Object();

				 		var options = Array.prototype.slice.call(arguments, 0);
				 		var database = options.shift();//Removed the first thre elements which is database that is being called
				 		var tableName = options.shift(); //assign table name and remove from list of options
				 		tableName = tableName.toLowerCase();
				 		size = options.length
				 		

				 		var retrievedObject = localStorage.getItem(database);
				 		retrievedObject = JSON.parse(retrievedObject);
				 		
				 		
				 		retrievedObject[tableName] = Object();

				 		
				 		loopVar = 0

				 		while(loopVar < size)
				 		{
				 			
				 			var prop = options[loopVar];
				 	
				 			retrievedObject[tableName][prop] = Array();
				 			loopVar++;
				 		}
				 		
				 		localStorage.setItem(database, JSON.stringify(retrievedObject));
				 		 return;
	 					

			 		// }	
			 		// else
			 		// {
			 		// 	alert("Database Already Exists") SHOULD BE CONSOLE.WARN
			 		// }
			 	}
			var setValues = function(database, table, values) //Set the values in a database row, if no value is set then it leaves it as nullllll
				{
					var values = Array.prototype.slice.call(arguments, 0);
					var database = values.shift();
					var table = values.shift(); 
					table = table.toLowerCase();
					
					var retrievedObject = JSON.parse(localStorage.getItem(database));
					var loopVar = 0;
					
				
					while(loopVar < values.length)
					{
						// console.log(values); //array of objects
						for(var property in values[loopVar])
						{
							// displays the property name  console.log(property);
						
							value = values[loopVar][property]// the value of the propery 
							
							retrievedObject[table][property].push(value);
							//retrievedObject[property].push(value); //pushes the value to the property in the object
						} 
						loopVar++;
					}
					
					localStorage.setItem(database, JSON.stringify(retrievedObject));
						/// TO DO: CHECK IF ROW EXISTS AND CONSOLE.WARN IF NOT
				}


			function _checkTableIntegrity()
			{
				//THIS FUNCTION CHECKS TO ENSURE THAT EACH ROW IN TABLE HAS THE SAME AMOUNT.
				//IF SOMEONE ENETERS A ROW WITH A VALUE MISSING THEN THAT DATA WILL END UP BEHIND
				//THIS FUNCTION SHOULD BE CALLED ANYTIME "setValues()" IS AND ADDS A NULL VALUE
				//TO ANY FIELD THE USER DIDNT
			}

			var newField = function(table, row)
				{
					//TO DO: CHECK IF ROW ALREADY EXISTS AND ENSURE TABLR EXISTS OR CLOSE AND THROW ERROR
					var retrievedObject = JSON.parse(localStorage.getItem(table));
						retrievedObject[row] = "";
						localStorage.setItem(table, JSON.stringify(retrievedObject));
				}
			var returnTableToLocal = function(table)
			{
				return JSON.parse(localStorage.getItem(table));
			}

			var getTableValue = function(table, row)
			{
				//TO DO: Implement check to see if table and row exists
				var retrievedObject = JSON.parse(localStorage.getItem(table));
				return retrievedObject[row]
			}

			var checkTableExists = function(database, table)
			{
				var retrievedObject = localStorage.getItem(database);
				retrievedObject = JSON.parse(retrievedObject);

				if(!retrievedObject[table]){return false;}
				else{return true;}
			}



			   return {
			    create: createDatabase,
			    newTable: newTable,
			    setValues: setValues,
			    addFile: newField,
			    getTable: returnTableToLocal,
			    readValue: getTableValue,
			    checkTable: checkTableExists,
			  };
		

	})()

	 //dataBase.create("workouts");  //creates an object(database) with the given name
	 //dataBase.newTable("workouts" ,"bench", "date","weight", "reps");  //creates a table with the given rows - these currently cannot be changed

	//dataBase.setValues("workouts", "shoulderPress", {date:1}, {weight: 250}, {reps:4}); // sets values in table - sent in an {attribute:value} format
	// test = dataBase.checkTable('workouts', 'benchs');

	var retrievedObject = localStorage.getItem("workouts");
				 		retrievedObject = JSON.parse(retrievedObject);
				 		console.log(retrievedObject);


	

</script>